<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="x-ua-compatible" content="ie=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Website</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.css' rel='stylesheet' />
    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.min.js'></script>
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.css' type='text/css' />
    <style>
        body {
            background-color: black !important;
        }
        #data {
            background-color: black;

        }

        #location {
            margin: auto;
            text-align: center;
        }
        body > .navbar {
            color: black !important;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-dark bg-black">
    <span class="navbar-brand mb-0 h1">Weather App</span>
</nav>
<br>
<div id="location" class="text-white"></div>
<br>

<div class="container" style="margin: auto">
    <div id="data" class="row rounded" style="margin: auto"></div>
</div>


<div id='map' class="rounded card-header" style='width: 80vw; height: 40em; margin: auto; margin-top: 3em'></div>


<br>
<br>




<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="JS/mapbox-geocoder-utils.js"></script>
<script src="js/api-key.js"></script>
<script>



    function fahrenheit(input) {
     let output = (9 / 5) * input - 459.67
        return output.toFixed(1)
    }
    <!--Formula for Fahrenheit-->
    let locale = []
    let superArr = []
    let count = 5;
    $.ajax({
        url: "http://api.openweathermap.org/data/2.5/forecast",
        type: "GET",
        data: {
            APPID: OPEN_WEATHER_APPID,
            q:     "Bonneau, US"
        }
    }).done(function(data) {
        console.log(data)
        $('#location').empty()
        let para = "";
        para += '<h3>' + data.city.name + ", " + data.city.country + '</h3>';
        $('#location').append(para)
        $('#data').empty()
        if (data.list[0].weather[0].icon === '01d' || data.list[0].weather[0].icon === '02d' || data.list[0].weather[0].icon === '03d' || data.list[0].weather[0].icon === '01n' || data.list[0].weather[0].icon === '02n' || data.list[0].weather[0].icon === '03n') {
            $('body').css('background-image', "url('sunny.jpg')");
            $('body').css('background-size', "cover")

        }
        else if (data.list[0].weather[0].icon === '09d' || data.list[0].weather[0].icon === '10d' || data.list[0].weather[0].icon === '09n' || data.list[0].weather[0].icon === '10n') {
            $('body').css('background-image', "url('rainy.jpg')");
            $('body').css('background-size', "cover")
        }
        else if (data.list[0].weather[0].icon === '04d' || data.list[0].weather[0].icon === '03d' || data.list[0].weather[0].icon === '04n' || data.list[0].weather[0].icon === '03n' ) {
            $('body').css('background-image', "url('cloudy.jpg')");
            $('body').css('background-size', "cover")
        }
        else if (data.list[0].weather[0].icon === '11d' || data.list[0].weather[0].icon === '11d') {
            $('body').css('background-image', "url('stormy.jpg')");
            $('body').css('background-size', "cover")
        }
        else if(data.list[0].weather[0].icon === '13d'|| data.list[0].weather[0].icon === '13n' ) {
            $('body').css('background-image', "url('snowy.jpg')");
            $('body').css('background-size', "cover")
        }
        else {

        }
        data.list.forEach(x => {
        if (x.dt_txt.split(' ')[1] === '15:00:00') {


            if (count === 0) {

            }
            else {


        let html = "";
        html += '<div class="col card-header text-white"><p class="mb-4 card-header">' + x.dt_txt.split(' ')[0] + "</p>";
        html += '<p class="mb-2">' + fahrenheit(x.main.temp_min) + '˚F' + ' / ' + fahrenheit(x.main.temp_max) + '˚F' + '</p>';
        html += '<img src="http://openweathermap.org/img/w/' + x.weather[0].icon + '.png">'
        html += '<p class="mb-2">' + 'Desciption: ' + "<strong>" + x.weather[0].description + "</strong>" + '</p>';
        html += '<p class="mb-2">' + 'Humdidity: ' + x.main.humidity + '</p>';
        html += '<p class="mb-2"> '+ 'Wind: ' + x.wind.speed + '</p>';
        html += '<p>' + 'Pressure: ' + x.main.pressure + '</p>'
        html += '</div>';
        // html += '<h3>' + data.city.name + '</h3>'

        $('#data').append(html)
        count--
    }

        }
        })

    });

    mapboxgl.accessToken = token;

    var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/satellite-streets-v11',
        zoom: 10,
        center: [-79.9579, 33.3054]

    });
    const geocoder = new MapboxGeocoder({
        // Initialize the geocoder
        accessToken: mapboxgl.accessToken, // Set the access token
        mapboxgl: mapboxgl, // Set the mapbox-gl instance
        marker: true // Do not use the default marker style
    });
    geocoder.on('result', function(e) {

        let word = e.result.place_name
        findLoc(e.result.center, word)
    })



    map.addControl(geocoder);

//    start of click marker

    marker = new mapboxgl.Marker();
    map.on('click', addMarker)





    //start on text input
    function findLoc(coordinates, str) {

        let word = str


        let superArr = []
        let count = 5;
        $.ajax({
            url: "http://api.openweathermap.org/data/2.5/forecast",
            type: "GET",
            data: {
                APPID: OPEN_WEATHER_APPID,
                lat:    coordinates[1],
                lon:   coordinates[0],
            }
        }).done(function(data) {

            $('#location').empty()
            let para = "";
            para += '<h3>' + data.city.name + ", " + data.city.country + '</h3>';
            $('#location').append(para)
            $('#data').empty()
            console.log(data.list[0].weather[0].icon)
            if (data.list[0].weather[0].icon === '01d' || data.list[0].weather[0].icon === '02d' || data.list[0].weather[0].icon === '03d' || data.list[0].weather[0].icon === '01n' || data.list[0].weather[0].icon === '02n' || data.list[0].weather[0].icon === '03n') {
                $('body').css('background-image', "url('sunny.jpg')");
                $('body').css('background-size', "cover")

            }
            else if (data.list[0].weather[0].icon === '09d' || data.list[0].weather[0].icon === '10d' || data.list[0].weather[0].icon === '09n' || data.list[0].weather[0].icon === '10n') {
                $('body').css('background-image', "url('rainy.jpg')");
                $('body').css('background-size', "cover")
            }
            else if (data.list[0].weather[0].icon === '04d' || data.list[0].weather[0].icon === '03d' || data.list[0].weather[0].icon === '04n' || data.list[0].weather[0].icon === '03n' ) {
                $('body').css('background-image', "url('cloudy.jpg')");
                $('body').css('background-size', "cover")
            }
            else if (data.list[0].weather[0].icon === '11d' || data.list[0].weather[0].icon === '11d') {
                $('body').css('background-image', "url('stormy.jpg')");
                $('body').css('background-size', "cover")
            }
            else if(data.list[0].weather[0].icon === '13d'|| data.list[0].weather[0].icon === '13n' ) {
                $('body').css('background-image', "url('snowy.jpg')");
                $('body').css('background-size', "cover")
            }
            else {

            }
            data.list.forEach(x => {
                if (x.dt_txt.split(' ')[1] === '00:00:00') {
                    if (count === 0) {

                    } else {


                        let html = "";

                        html += '<div class="col card-header text-white"><p class="mb-4 card-header">' + x.dt_txt.split(' ')[0] + "</p>";
                        html += '<p class="mb-2">' + fahrenheit(x.main.temp_min) + '˚F' + ' / ' + fahrenheit(x.main.temp_max) + '˚F' + '</p>';
                        html += '<img src="http://openweathermap.org/img/w/' + x.weather[0].icon + '.png">'
                        html += '<p class="mb-2">' + 'Desciption: ' + "<strong>" + x.weather[0].description + "</strong>" + '</p>';
                        html += '<p class="mb-2">' + 'Humdidity: ' + x.main.humidity + '</p>';
                        html += '<p class="mb-2"> ' + 'Wind: ' + x.wind.speed + '</p>';
                        html += '<p>' + 'Pressure: ' + x.main.pressure + '</p>'
                        html += '</div>';

                        $('#data').append(html)
                        count--
                    }
                }
            })
        });


    word.value = ""
    }





    //end of text input adding the function addmarker


    function addMarker(event) {

        var input = event.lngLat;

        marker.setLngLat(input).addTo(map);



        let superArr = []
        let count = 5;
        $.ajax({
            url: "http://api.openweathermap.org/data/2.5/forecast",
            type: "GET",
            data: {
                APPID: OPEN_WEATHER_APPID,
                lat:    input.lat,
                lon:   input.lng,
            }
        }).done(function(data) {
            $('#location').empty()
            let para = "";
            para += '<h3>' + data.city.name + ", " + data.city.country + '</h3>';
            $('#location').append(para)
            $('#data').empty()
            if (data.list[0].weather[0].icon === '01d' || data.list[0].weather[0].icon === '02d' || data.list[0].weather[0].icon === '03d' || data.list[0].weather[0].icon === '01n' || data.list[0].weather[0].icon === '02n' || data.list[0].weather[0].icon === '03n') {
                $('body').css('background-image', "url('sunny.jpg')");
                $('body').css('background-size', "cover")

            }
            else if (data.list[0].weather[0].icon === '09d' || data.list[0].weather[0].icon === '10d' || data.list[0].weather[0].icon === '09n' || data.list[0].weather[0].icon === '10n') {
                $('body').css('background-image', "url('rainy.jpg')");
                $('body').css('background-size', "cover")
            }
            else if (data.list[0].weather[0].icon === '04d' || data.list[0].weather[0].icon === '03d' || data.list[0].weather[0].icon === '04n' || data.list[0].weather[0].icon === '03n' ) {
                $('body').css('background-image', "url('cloudy.jpg')");
                $('body').css('background-size', "cover")
            }
            else if (data.list[0].weather[0].icon === '11d' || data.list[0].weather[0].icon === '11d') {
                $('body').css('background-image', "url('stormy.jpg')");
                $('body').css('background-size', "cover")
            }
            else if(data.list[0].weather[0].icon === '13d'|| data.list[0].weather[0].icon === '13n' ) {
                $('body').css('background-image', "url('snowy.jpg')");
                $('body').css('background-size', "cover")
            }
            else {

            }
            data.list.forEach(x => {
                if (x.dt_txt.split(' ')[1] === '00:00:00') {
                    if (count === 0) {

                    } else {


                        let html = "";

                        html += '<div class="col card-header text-white"><p class="mb-4 card-header">' + x.dt_txt.split(' ')[0] + "</p>";
                        html += '<p class="mb-2">' + fahrenheit(x.main.temp_min) + '˚F' + ' / ' + fahrenheit(x.main.temp_max) + '˚F' + '</p>';
                        html += '<img src="http://openweathermap.org/img/w/' + x.weather[0].icon + '.png">'
                        html += '<p class="mb-2">' + 'Desciption: ' + "<strong>" + x.weather[0].description + "</strong>" + '</p>';
                        html += '<p class="mb-2">' + 'Humdidity: ' + x.main.humidity + '</p>';
                        html += '<p class="mb-2"> ' + 'Wind: ' + x.wind.speed + '</p>';
                        html += '<p>' + 'Pressure: ' + x.main.pressure + '</p>'
                        html += '</div>';

                        $('#data').append(html)
                        count--
                    }
                }
            })
        });


    }


</script>
</body>
</html>